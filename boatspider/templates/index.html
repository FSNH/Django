{% extends 'base.html' %}
{% block info %}

    <div class="span6">
    </div>
    <div class="span6" >
        <div class="dataTables_filter" id="example_filter" style="padding-top: 10px;float: right">
            <form action="{% url 'index' %}" method="get">
               <button type="submit" class="el-btn btn-danger" style="border-radius: 5px;height: 30px"><i class="bi bi-search" style="font-size: 1rem; color: white;padding: 5px;"></i>搜索</button>
               <input class="el-button--text" placeholder="项目名称" name="company_name" style="height: 25px">
            </form>
        </div>
    </div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>项目编号</th>
            <th>项目名称</th>
            <th>爬虫名称</th>
            <th>网站名称</th>
            <th>cas查询</th>
            <th>优先级</th>
            <th>配置爬虫</th>
            <th>创建时间</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

{% endblock %}

{% block script %}
    $(document).ready(function(){
        $.get("/api/spiders/",function (data){
                content = [];
                for(var i=0;i<data.length;i++){
                    if(data[i].status==200){
                        html = "<tr>"+"<td class='num'>"+(i+1)+"</td>"+"<td class='name'>"+data[i].project+"</td>"+"<td class='spider_name'>"+data[i].spider_name+"</td>"+"<td class='company_name'>"+data[i].company_name+"</td>"+"<td class='is_cas'>"+"<button type='button' disabled='disabled' class='el-btn btn-warning' style='color: white;border: none;border-radius:3px'>"+data[i].is_cas+"</button>"+"</td>"+"<td class='is_priority'>"+"<button type='button' disabled='disabled' class='el-btn btn-warning' style='color: white;border: none;border-radius:3px'>"+data[i].is_priority+"</button>"+"</td>"+"<td class='monitor'>"+"<button type='button' disabled='disabled' class='el-btn btn-warning' style='color: white;border: none;border-radius:3px'>"+data[i].is_monitor+"</button>"+"</td>"+"<td class='create'>"+data[i].create+"</td>"+"<td>"+"<button type='button' disabled='disabled' class='el-btn btn-success' style='color: white;border: none;border-radius:2px'>"+"<a style='text-decoration: none;color: white' href=monitor/scrapyinfo/"+data[i].id+".html>详情</a>"+"</button>"+"</td>"+"<td><button type='button' disabled='disabled' class='el-btn btn-danger' style='border: none;border-radius:2px'>"+"<a style='text-decoration: none;color: white' href=istrue/"+data[i].id+">配置</a>"+"</button></td>"+"<td><button type='button' class='el-btn btn-info' style='border: none;border-radius:2px'>"+"<a style='text-decoration: none;color: white' href=isdelete/"+data[i].id+">取消</a>"+"</button></td>"+"</tr>"
                        content.push(html);
                    }else{
                        alert("加载失败")
                    }

                }
                if(content.length>0){
                    console.log(content)
                    $("tbody").html(content.join("\n"));
                } else {
                    console.log(content.length);

                }

            })
    })
{% endblock %}

