{% extends "base.html" %}
    {% block style %}
        .col-md-10{
            position: relative;
            min-height: 1px;
            padding-right: 0px;
            padding-left: 40px;
            overflow-y: scroll;
            height:1130px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
         .col-md-10::-webkit-scrollbar {
            display: none; /* Chrome Safari */
        }
        input{
            padding-left:10px;
            margin-right:15px;
        }
    {% endblock %}

    {% block info %}
    <div class="col-md-10" style="margin:0 auto;">
        <div class="row clearfix">
        <div class="el-col-md-12" style="height: 100px;background-color: #f5f5f5;margin: 10px 0px 10px 20px;">
            <!--导航-->
            <div class="menu">
                <ul class="breadcrumb">
                <li class="active">
                     <a href="{% url 'index' %}">首页</a>
                </li>
                <li>
                     <a href="{% url 'search'%}">检索</a>
                </li>
                <li class="disabled">
                     <a href="#">信息</a>
                </li>
            </ul>
            </div>
            <div class="filter" style="padding-left: 15px">
                <form action="{% url 'index' %}" method="post">
                   <input class="el-button--text" placeholder="公司名称" name="company_name">
                   <button type="submit" class="el-btn btn-danger" style="border-radius: 5px"><i class="bi bi-search" style="font-size: 1rem; color: white;padding: 5px;"></i>搜索</button>
                </form>
            </div>
        </div>
        <div class="col-md-12 column col-offset-1">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th>公司编号</th>
                <th>公司名称</th>
                <th>合作平台数量</th>
                <th>平台类型</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            {% for s in info %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td class="name">{{ s.company_name }}</td>
                    <td class="num" _id="{{ forloop.counter0}}">{{ s.num }}</td>
                    <td class="source" _id="{{ forloop.counter0}}">{{ s.sourcelist }}</td>
                    <td class="link" _id="{{ forloop.counter0}}">详情</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
{#        <span style="float: left">#}
{#        {% if page.has_previous %}#}
{#        <!--//判断当前页是否有上一页-->#}
{#        <button class="btn btn-info btn-sm">#}
{#            <a href="/app/index.html?page={{page.previous_page_number}}" aria-label="Previous"><span aria-hidden="true" id="pre">上一页</span></a>#}
{#        </button>#}
{##}
{#        {% endif %}#}
{#        </span>#}
{#        <div style="float: left;margin-left: 600px ">第{{ page.number }}页/共{{ page_nums }}页</div>#}
{#        <span style="float: right">#}
{#        {% if page.has_next %}#}
{#    <!-- // 判断当前页是否有下一页-->#}
{#             <button class="btn btn-info btn-sm">#}
{#             <a href="/app/index.html?page={{page.next_page_number}}" aria-label="Next"><span aria-hidden="true">下一页</span></a>#}
{#             </button>#}
{#          {% endif %}#}
{#   </span>#}
    </div>
    </div>
    </div>
    {% endblock %}

{% block script %}
    $(document).ready(function(){
        list=[]
        $('.name').each(function(){
            list.push($(this).text())
        })
        if(list.length>0){
             $.post("http://127.0.0.1:8001/app/api/getcalcua_data/",{"data":list.join(";")},function (data){
                for(var i=0;i<data.length;i++){
                    $('.num[_id="'+i+'"]').text(data[i].num)
                    $('.source[_id="'+i+'"]').text(data[i].sourcelist)
                    $('.link[_id="'+i+'"]').html('<button type="button" class="btn-xs btn-warning"><a href="/app/detail/?name='+data[i].company_name+'&source='+data[i].sourcelist+'">详情</a></button>')
                }
                console.log(data)
             })

        }

    });
{% endblock %}
