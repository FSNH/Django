{% extends 'base1.html' %}
{% block info %}
    <div class="span6">
        <div style="float: left;padding-top: 10px">第{{ page.number }}页/共{{ page_nums }}页</div>
    </div>
    <div class="span6" >
        <div class="dataTables_filter" id="example_filter" style="padding-top: 10px;float: right">
            <form action="{% url 'index' %}" method="get">
               <button type="submit" class="el-btn btn-danger" style="border-radius: 5px;height: 30px"><i class="bi bi-search" style="font-size: 1rem; color: white;padding: 5px;"></i>搜索</button>
               <input class="el-button--text" placeholder="公司名称" name="company_name" style="height: 25px">
            </form>
        </div>
    </div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>公司编号</th>
            <th>公司名称</th>
            <th>合作平台数量</th>
            <th>平台类型</th>
            <th>产品数量Max</th>
            <th>Chem960Vip</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        {% for s in page %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td class="name">{{ s.company_name }}</td>
                <td class="num" _id="{{ forloop.counter0}}">{{ s.pt_num }}</td>
                <td class="source" _id="{{ forloop.counter0}}">{{ s.pt_sources }}</td>
                <td class="product_num" _id="{{ forloop.counter0}}">{{ s.product_num_max }}</td>
                <td class="vip" _id="{{ forloop.counter0}}"></td>
                <td class="link" _id="{{ forloop.counter0}}"><button type="button" class="btn-xs" style="background-color: #ff7a03;border: none;border-radius:3px"><a href="/app/detail.html?name={{ s.company_name }}&source={{ s.pt_sources }}" style="color: white">详情</a></button></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <span style="float: left">
    {% if page.has_previous %}
    <!--//判断当前页是否有上一页-->
    <button class="btn btn-info btn-sm">
        <a href="/app/index.html?page={{page.previous_page_number}}" aria-label="Previous"><span aria-hidden="true" id="pre" style="color: white">上一页</span></a>
    </button>
    {% endif %}
    </span>
    <span style="float: right">
    {% if page.has_next %}
    <!-- // 判断当前页是否有下一页-->
         <button class="btn btn-info btn-sm">
         <a href="/app/index.html?page={{page.next_page_number}}" aria-label="Next"><span aria-hidden="true" style="color: white">下一页</span></a>
         </button>
      {% endif %}
    </span>


{% endblock %}
{% block script %}
    $(document).ready(function(){
        list=[]
        $('.name').each(function(){
            list.push($(this).text())
        })
{#        console.log(list)#}
        $.post("/app/api/check_chem960vip/",{'data':list.join(';')},function (data){
                for(var i=0;i<data.length;i++){
                    console.log(data[i].status)
                    if(data[i].status=='是'){
                        $(".vip[_id="+i+"]").html('<button type="button" disabled="disabled" class="el-btn btn-success" style="color: white;border: none;border-radius:3px">是</button>')
                    }else{
                        $(".vip[_id="+i+"]").html('<button type="button" disabled="disabled" class="el-btn btn-default" style="color: white;border: none;border-radius:3px;background-color: #ddd">否</button>')
                    }

                }
                console.log(data)
            })
    })
{% endblock %}

